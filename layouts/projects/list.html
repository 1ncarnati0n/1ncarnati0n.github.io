{{ define "main" }}

<section class="page-header">
  <h1 class="page-title">Projects</h1>
  <p class="page-description">Architecture & Design Portfolio</p>
</section>

{{/* Category Filter */}}
{{ $categories := slice }}
{{ range (where .Site.RegularPages "Section" "projects") }}
  {{ with .Params.category }}
    {{ $categories = $categories | append . }}
  {{ end }}
{{ end }}
{{ $categories := uniq $categories }}

{{ if $categories }}
<div class="filter-bar">
  <button class="filter-btn active" data-filter="all">All</button>
  {{ range $categories }}
  <button class="filter-btn" data-filter="{{ . }}">{{ . }}</button>
  {{ end }}
</div>
{{ end }}

{{/* Project Grid */}}
<div class="project-grid project-grid--full">
  {{ range (where .Site.RegularPages "Section" "projects").ByDate.Reverse }}
  <article class="project-card fade-in" data-category="{{ .Params.category }}">
    <a href="{{ .RelPermalink }}">
      <figure class="project-card-image">
        {{ with .Params.thumbnail }}
        <img src="{{ . | relURL }}" alt="{{ $.Title }}" loading="lazy">
        {{ end }}
      </figure>
      <div class="project-card-overlay">
        <span class="project-card-title">{{ .Title }}</span>
        {{ with .Params.category }}
        <span class="project-card-category">{{ . }}</span>
        {{ end }}
      </div>
    </a>
  </article>
  {{ end }}
</div>

<div class="back-to-top">
  <a href="#top">Back to Top</a>
</div>

{{ end }}

{{ define "scripts" }}
<script>
  // Category filter functionality
  document.querySelectorAll('.filter-btn').forEach(function(btn) {
    btn.addEventListener('click', function() {
      var filter = this.getAttribute('data-filter');

      document.querySelectorAll('.filter-btn').forEach(function(b) {
        b.classList.remove('active');
      });
      this.classList.add('active');

      document.querySelectorAll('.project-card').forEach(function(card) {
        if (filter === 'all' || card.getAttribute('data-category') === filter) {
          card.style.display = '';
          card.style.opacity = '0';
          setTimeout(function() { card.style.opacity = '1'; }, 50);
        } else {
          card.style.display = 'none';
        }
      });
    });
  });
</script>
{{ end }}

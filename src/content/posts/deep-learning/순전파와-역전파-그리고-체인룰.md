---
title: "μμ „νμ™€ μ—­μ „ν κ·Έλ¦¬κ³  μ²΄μΈλ£°"
date: 2024-01-01
tags: []
draft: false
---



λ”¥λ¬λ‹μ ν•µμ‹¬ λ©”μ»¤λ‹μ¦ μ¤‘ ν•λ‚μΈ μμ „νμ™€ μ—­μ „ν κ³Όμ •μ„ μμ‹μ μΌλ΅ κΉμ΄ μκ² λ‹¤λ¤„λ³΄μ. 

λ¨Όμ €, μ‹ κ²½λ§μ μ—­μ „νλ¥Ό μ΄ν•΄ν•κΈ° μ„ν•΄ ν•„μ”ν• λ‘ κ°€μ§€ μ¤‘μ”ν• λ―Έμ λ¶„ν•™ κ΄€λ ¨ κ°λ…μΈ νΈλ―Έλ¶„κ³Ό ν•©μ„± ν•¨μμ λ―Έλ¶„μ— λ€ν•΄ κ°„λ‹¨ν μ•μ•„λ³΄μ.

μ°μ„  νΈλ―Έλ¶„μ€ λ‹¤λ³€μ ν•¨μμ—μ„ ν• λ³€μμ λ³€ν™”κ°€ ν•¨μμ— λ―ΈμΉλ” μν–¥μ„ μΈ΅μ •ν•κΈ° μ„ν•΄ μ‚¬μ©λλ‹¤. λ‹¤λ¥Έ λ¨λ“  λ³€μλ” μƒμλ΅ κ°„μ£Όν•λ©΄μ„ ν•΄λ‹Ή λ³€μμ— λ€ν•΄μ„λ§ λ―Έλ¶„μ„ μ§„ν–‰ν•λ” κ²ƒμ΄λ‹¤. 

μλ¥Ό λ“¤μ–΄, ν•¨μ $f(x, y) = x^2 y + 3xy + y^2$ μ—μ„ π‘¥μ— λ€ν• νΈλ―Έλ¶„μ„ κ³„μ‚°ν•λ©΄, π‘¦λ¥Ό μƒμλ΅ κ°„μ£Όν•κ³  π‘¥μ— λ€ν•΄μ„λ§ λ―Έλ¶„μ„ μν–‰ν•λ‹¤. μμ‹μΌλ΅ ν‘ν„ν•λ©΄ μ•„λμ™€ κ°™λ‹¤.

$$ \frac{\partial f}{\partial x} = 2xy + 3y $$

μ΄λ²μ—λ” π‘¥λ¥Ό μƒμλ΅ κ°„μ£Όν•κ³  π‘¦μ— λ€ν•΄μ„λ§ λ―Έλ¶„μ„ ν•΄ λ³Έλ‹¤. μ•„λμ²λΌ κ²°κ³Όκ°€ λ‚μ¨λ‹¤.

$$ \frac{\partial f}{\partial y} = x^2 + 3x + 2y $$

ν•©μ„± ν•¨μμ λ―Έλ¶„μ€ λ³µμ΅ν• ν•¨μλ“¤μ΄ μ„λ΅ κ²°ν•©λμ–΄ μμ„ λ• μ‚¬μ©λλ‹¤. μ΄λ” μ²΄μΈλ£°(Chain Rule)μ΄λΌκ³  ν•λ” κ·μΉ™μ„ μ‚¬μ©ν•μ—¬ μ™Έλ¶€ ν•¨μμ λ―Έλ¶„κ³Ό λ‚΄λ¶€ ν•¨μμ λ―Έλ¶„μ„ κ³±ν•΄ μ „μ²΄ λ―Έλ¶„μ„ κµ¬ν•λ” λ°©μ‹μΈλ°. 

μλ¥Ό λ“¤μ–΄, π‘¦=π‘“(π‘”(π‘¥))μ ν•νƒλ¥Ό κ°–λ” ν•¨μμ—μ„ π‘¥μ— λ€ν• π‘¦μ λ―Έλ¶„μ„ κµ¬ν•λ©΄, π‘”(π‘¥)μ λ―Έλ¶„κ³Ό π‘“(π‘”)μ λ―Έλ¶„μ„ κ³±ν•μ—¬ μ•„λμ™€ κ°™μ΄ κ³„μ‚°ν•λ‹¤.

$$ \frac{dy}{dx} = \frac{df}{dg} \cdot \frac{dg}{dx} $$

μ‹ κ²½λ§μ€ μ΄λ ‡κ² λ³µμ΅ν• ν•©μ„± ν•¨μλ΅ κµ¬μ„±λμ–΄ μλ‹¤κ³  μ΄ν•΄ν•  μ μλ‹¤. μ‹ κ²½λ§μ—μ„ κ° λ μ΄μ–΄λ” κ°€μ¤‘ν•© μ—°μ‚°κ³Ό ν™μ„±ν™” ν•¨μλ¥Ό ν¬ν•¨ν•κ³  μμΌλ©°, μ΄ λ‘ μ”μ†κ°€ κ²°ν•©λμ–΄ ν•λ‚μ ν•¨μλ¥Ό ν•μ„±ν•λ‹¤. μ΄λ ‡κ² κ° λ μ΄μ–΄λ¥Ό κ±°μΉλ©΄μ„ λ‹¤μ–‘ν• ν•¨μλ“¤μ΄ κ²°ν•©λμ–΄, μ „μ²΄ μ‹ κ²½λ§μ€ μ—°μ†μ μΈ ν•©μ„± ν•¨μλ΅ κµ¬μ„±λλ‹¤κ³  λ³Ό μ μλ‹¤. μ΄λ¬ν• κµ¬μ΅° λ•λ¬Έμ— μ‹ κ²½λ§μ„ λ―Έλ¶„ν•  λ•λ” ν•©μ„± ν•¨μμ λ―Έλ¶„λ²•μ„ μ μ©ν•λ‹¤.

μ΄μ–΄μ„ μ—­μ „ν, μμ „ν κ³Όμ •μ—μ„μ κ³„μ‚° κ³Όμ •μ„ μ•μ•„λ³΄κ² λ‹¤. ν”ν λ”¥ λ¬λ‹ λ¨λΈμ—μ„ λ°μ΄ν„°κ°€ μ²λ¦¬λλ” λ°©μ‹μ€ ν¬κ² μμ „ν(Forward Propagation)μ™€ μ—­μ „ν(Backpropagation) λ‘ κ³Όμ •μΌλ΅ λ‚λ‰λ”λ°μ”. κ° κ°λ…μ„ κ°„λ‹¨ν λ³µμµν•΄ λ³΄κ² λ‹¤.

μμ „νλ” μ…λ ¥ λ°μ΄ν„°κ°€ λ„¤νΈμ›ν¬μ μ²μλ¶€ν„° λκΉμ§€ νλ¬κ°€λ” κ³Όμ •μ΄λ‹¤. μ΄ κ³Όμ •μ—μ„ κ° λ μ΄μ–΄λ” μ…λ ¥ λ°μ΄ν„°μ— λ€ν•΄ μ„ ν• λ³€ν™(μ: κ°€μ¤‘μΉμ™€ νΈν–¥μ„ μ΄μ©ν• κ³„μ‚°)κ³Ό ν™μ„±ν™” ν•¨μ(μ: ReLU, Sigmoid)λ¥Ό μ μ©ν•λ‹¤. μ΄λ¬ν• κ³„μ‚°μ„ ν†µν•΄ μ…λ ¥ λ°μ΄ν„°λ” μµμΆ…μ μΌλ΅ μ¶λ ¥μΈµμ— λ„λ‹¬ν•κ³ , λ¨λΈμ€ μμΈ΅ κ²°κ³Όλ¥Ό μƒμ„±ν•λ‹¤. 

μ—­μ „νλ” λ¨λΈμ μμΈ΅ κ²°κ³Όμ™€ μ‹¤μ  κ°’κ³Όμ μ°¨μ΄(μ†μ‹¤)λ¥Ό κ³„μ‚°ν• ν›„, μ΄ μ†μ‹¤ κ°’μ„ μ‚¬μ©ν•μ—¬ λ¨λΈμ κ° νλΌλ―Έν„°(κ°€μ¤‘μΉ)λ¥Ό μ΅°μ •ν•λ” κ³Όμ •μ΄λ‹¤. μ†μ‹¤ ν•¨μλ¥Ό ν†µν•΄ κ³„μ‚°λ μ†μ‹¤μ„ κΈ°λ°μΌλ΅, μ•μ„ λ°°μ΄ Chain Ruleμ„ μ΄μ©ν•΄ κ° λ μ΄μ–΄μ™€ λ‰΄λ°μ κ°€μ¤‘μΉμ— λ€ν• μ†μ‹¤μ λ―Έλ¶„κ°’(κΈ°μΈκΈ°)μ„ κ³„μ‚°ν•κ³ , μ΄ κΈ°μΈκΈ°λ¥Ό μ‚¬μ©ν•μ—¬ κ°€μ¤‘μΉλ¥Ό μ—…λ°μ΄νΈν•λ‹¤.

κ³„μ‚° κ³Όμ •μ„ μ•μ•„λ³΄κΈ° μ„ν•΄, μΌλ‹¨ κ°„λ‹¨ν• μμ‹λ¥Ό λ“¤μ–΄λ³΄κ² λ‹¤. μ…λ ¥ λ°μ΄ν„°λ” $x$, κ° μΈµμ—μ„ μ μ©ν•  κ°€μ¤‘μΉ κ°’μ€ $w_1$κ³Ό $w_2$ μ΄κ³ . μΌλ‹¨ μ…λ ¥ $x$μ— κ°€μ¤‘μΉ$w_1$μ„ κ³±ν• ν›„ μ‹κ·Έλ¨μ΄λ“ ν•¨μλ¥Ό μ μ©ν•μ—¬ μ¶λ ¥κ°’ $a_1$μ„ μƒμ„±ν•λ‹¤.

$$ z_1 = w_1 \cdot x $$  
$$ a_1 = \sigma(z_1) $$

μ΄ μ¶λ ¥κ°’ $a_1$ μ€ λ‹¤μ μΈµμΌλ΅ μ „λ‹¬λλ‹¤. μ΄κ² μ¶λ ¥μΈµμ΄λΌκ³  ν•λ©΄, $a_1$ μ— κ°€μ¤‘μΉ $w_2$ λ¥Ό κ³±ν•μ—¬ μµμΆ…μ μΌλ΅ μμΈ΅κ°’ $y_{pred}$ λ¥Ό κ³„μ‚°ν•κ² λλ”λ°. μ΄ κ³Όμ •μ„ ν†µν•΄ μ…λ ¥ λ°μ΄ν„°λ” μ΄κΈ° λ‹¨κ³„μ—μ„ μ²λ¦¬λμ–΄ μµμΆ…μ μΈ μμΈ΅ κ²°κ³Όλ¥Ό μƒμ„±ν•κ² λλ‹¤.

$$ z_2 = w_2 \cdot a_1 $$  
$$ y_{\text{pred}} = \sigma(z_2) $$

λ‹¤μμ—λ” μ—­μ „ν κ³Όμ •μ— λ€ν•΄μ„λ„ μ•μ•„λ³΄κ² λ‹¤. μ°λ¦¬κ°€ ν„μ¬ κ³ λ ¤ν•κ³  μλ” λ‹¨μΈµ νΌμ…‰νΈλ΅ μ—μ„λ” μμ „ν κ³Όμ •μ„ ν†µν•΄ μ…λ ¥ λ°μ΄ν„°λ¥Ό λ°›μ•„ μµμΆ… μμΈ΅κ°’ $y_{pred}$λ¥Ό μƒμ„±ν•κ³ , μ΄ κ°’μ„ μ‚¬μ©ν•μ—¬ μ‹ κ²½λ§μ μ„±λ¥μ„ ν‰κ°€ν•λ”λ°. 

μ΄λ• μ†μ‹¤ ν•¨μλ΅λ” μ•„λμ™€ κ°™μ€ ν‰κ·  μ κ³± μ¤μ°¨(Mean Squared Error, MSE)λ¥Ό μ‚¬μ©ν•΄ λ³΄κ² λ‹¤.

$$ L = \frac{1}{2}(y_{\text{pred}} - y_{\text{true}})^2 $$

μ‹ κ²½λ§μ μ£Όλ λ©ν‘λ” μ΄ μ†μ‹¤ ν•¨μμ κ°’μ„ μµμ†ν™”ν•λ” κ²ƒμ΄λ©°, μ΄λ¥Ό μ„ν•΄ μ—­μ „ν κ³Όμ •μ„ ν†µν•΄ κ°€μ¤‘μΉ $w_1$ κ³Ό $w_2$ λ¥Ό μ—…λ°μ΄νΈν•λ‹¤. 

μ—­μ „ν κ³Όμ •μ€ μμ „νμ λ°λ€ λ°©ν–¥μΌλ΅ μ§„ν–‰λλ©°, μ΄ κ³Όμ •μ—μ„ κ°€μ¤‘μΉμ— λ€ν• μ†μ‹¤ ν•¨μμ κ·Έλλ””μ–ΈνΈ(λ―Έλ¶„κ°’)λ¥Ό κ³„μ‚°ν•λ”λ°. Chain Ruleμ„ μ‚¬μ©ν•μ—¬ μ΄ κ·Έλλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•κ³ , κ³„μ‚°λ κ·Έλλ””μ–ΈνΈλ” κ°€μ¤‘μΉμ μ—…λ°μ΄νΈλ¥Ό μ„ν•΄ μ‚¬μ©λλ‹¤. 

κµ¬μ²΄μ μΌλ΅, μ†μ‹¤ ν•¨μ πΏμ— λ€ν•΄ $w_2$μ κ·Έλλ””μ–ΈνΈλ¥Ό λ¨Όμ € κ³„μ‚°ν•κ³ , μ΄μ–΄μ„ $w_1$μ κ·Έλλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•λ‹¤. μ΄λ¬ν• κ·Έλλ””μ–ΈνΈ κ³„μ‚°μ€ κ° κ°€μ¤‘μΉμ μν–¥μ„ ν‰κ°€ν•κ³ , κ°€μ¤‘μΉλ¥Ό μ΅°μ •ν•¨μΌλ΅μ¨ μ†μ‹¤μ„ μ¤„μ΄λ” λ°©ν–¥μΌλ΅ μ‹ κ²½λ§μ„ μ΅°μ •ν•λ” λ° μ¤‘μ”ν• μ—­ν• μ„ ν•λ‹¤. 

μ΄λ ‡κ² μ—­μ „νλ¥Ό ν†µν• κ°€μ¤‘μΉ μ—…λ°μ΄νΈλ” μ‹ κ²½λ§μ΄ ν•™μµν•κ³  μ„±λ¥μ„ κ°μ„ ν•λ„λ΅ λ•λ”λ‹¤. λ¨Όμ €, μ„ μ†μ‹¤ν•¨μλ¥Ό $y_{pred}$ μ— λ€ν•΄ λ―Έλ¶„ν• ${\partial L}/{\partial y_{\text{pred}}}$ κ°’μ€ μ•„λμ™€ κ°™λ‹¤. μ°λ¦¬λ” μ΄ κ°’μ„ Chain Rule μ μ© κ³Όμ •μ—μ„ μ‚¬μ©ν•  κ²ƒμ΄λ‹¤.
$$ \frac{\partial L}{\partial y_{\text{pred}}} = (y_{\text{pred}} - y_{\text{true}}) $$


μ—­μ „ν κ³Όμ •μ—μ„, μ¶λ ¥μΈµμ κ°€μ¤‘μΉ $w_2$ μ— λ€ν• μ†μ‹¤ ν•¨μμ κ·Έλλ””μ–ΈνΈλ” Chain Ruleμ„ μ‚¬μ©ν•μ—¬ κ³„μ‚°λλ‹¤.

$$  
\frac{\partial L}{\partial w_2} =  
\frac{\partial L}{\partial y_{\text{pred}}}  
\cdot  
\frac{\partial y_{\text{pred}}}{\partial z_2}  
\cdot  
\frac{\partial z_2}{\partial w_2}  
$$

κ°€μ¤‘μΉ $w_1$μ— λ€ν• κ·Έλλ””μ–ΈνΈλ„ λΉ„μ·ν• λ°©μ‹μΌλ΅ κ³„μ‚°λλ‹¤. μ΄ κ·Έλλ””μ–ΈνΈλ” λ‹¤μκ³Ό κ°™μ€ μ„Έ κ°μ λ―Έλ¶„κ°’μ„ μ—°μ‡„μ μΌλ΅ κ³±ν•΄μ„ κµ¬ν•  μ μλ”λ°μ”. κ°κ°$β‚z_2/β‚a_1$ μ€ $w_2$ , $β‚z_1/β‚w_1$μ€ μ…λ ¥
$x$, $β‚a_11/β‚z_11$ μ€ $Οƒβ€²(z1)$ μ™€ κ°™λ‹¤. μ΄ λ¨λ“  λ―Έλ¶„κ°’λ“¤μ„ μ—°μ‡„μ μΌλ΅ κ³±ν•λ” κ²ƒμΌλ΅ $w_1$ μ— λ€ν• κ·Έλλ””μ–ΈνΈλ¥Ό κ³„μ‚°ν•λ©°, μ΄λ” λ¨λΈμ κ°€μ¤‘μΉλ¥Ό μ—…λ°μ΄νΈν•λ” λ° μ‚¬μ©λλ‹¤.

$$  
\frac{\partial L}{\partial w_1} =  
\frac{\partial L}{\partial y_{\text{pred}}}  
\cdot  
\frac{\partial y_{\text{pred}}}{\partial z_2}  
\cdot  
\frac{\partial z_2}{\partial a_1}  
\cdot  
\frac{\partial a_1}{\partial z_1}  
\cdot  
\frac{\partial z_1}{\partial w_1}  
$$

μ΄μ  λ³Έκ²©μ μΌλ΅ κ²½μ‚¬ ν•κ°•λ²•μ„ ν†µν•΄ $w_1$ κ³Ό $w_2$ λ¥Ό μ—…λ°μ΄νΈν•΄ λ³΄κ² λ‹¤. κ²½μ‚¬ ν•κ°•λ²•μ€ λ¨Έμ‹  λ¬λ‹κ³Ό λ”¥ λ¬λ‹μ—μ„ λ„λ¦¬ μ‚¬μ©λλ” μµμ ν™” κΈ°λ²•μΌλ΅, λ¨λΈμ μ†μ‹¤ ν•¨μλ¥Ό μµμ†ν™”ν•κΈ° μ„ν•΄ κ°€μ¤‘μΉλ¥Ό λ°λ³µμ μΌλ΅ μ΅°μ •ν•λ” λ°©λ²•μ΄λ‹¤. μ΄ κ³Όμ •μ—μ„ κ³„μ‚°λ κ° κ°€μ¤‘μΉμ— λ€ν• μ†μ‹¤ ν•¨μμ κ·Έλλ””μ–ΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ κ°€μ¤‘μΉλ¥Ό μ—…λ°μ΄νΈν•λ‹¤.

$$ w = w - \eta \cdot \frac{\partial L}{\partial w} $$

μ„ κ³µμ‹μ„ μ΄μ©ν•΄ μ„μ—μ„ κ³„μ‚°ν• κ° κ°€μ¤‘μΉμ κ·Έλλ””μ–ΈνΈμ— λ€ν•΄μ„ μ—…λ°μ΄νΈ ν•λ” κ³Όμ •μ€ μ•„λμ™€ κ°™λ‹¤. μ°Έκ³ λ΅ $w_1$ λ„ λ™μΌν•κ² μ μ©λλ‹¤κ³  λ³΄λ©΄ λλ‹¤.

$$ w_2 = w_2 - \eta \cdot \frac{\partial L}{\partial w_2} $$

 
$$  
\frac{\partial L}{\partial w_2}

(y_{\text{pred}} - y_{\text{true}})  
\cdot  
\sigma'(z_2)  
\cdot  
a_1  
$$

μ„ κ³Όμ •μ„ ν†µν•΄ κ° κ°€μ¤‘μΉ $w_1$ κ³Ό $w_2$ λ” μ£Όμ–΄μ§„ λ°μ΄ν„°μ— λ€ν•΄ μ†μ‹¤μ„ μµμ†ν™”ν•λ” λ°©ν–¥μΌλ΅ μ΅°μ •λλ‹¤.